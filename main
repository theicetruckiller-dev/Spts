local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local VirtualInputManager = game:GetService("VirtualInputManager")
local Player = Players.LocalPlayer
local PlayerGui = Player:WaitForChild("PlayerGui")

-- STATE VARS
local running = false
local infiniteJump = false
local autoPool = false
local hasTeleported = false
local lastPos = nil
local clickPosition = Vector2.new(401, 270)
local itemsSelected = {}
local selectedPool = 1
local momentorespawn = false

local autoStrength = false
local hasTeleStrengthTeleported = false
local strengthLocations = {
    Vector3.new(403, 249, 988),  -- Normal Taş
    Vector3.new(-2275, 1943, 1051) -- Mavi Kristal
}
local selectedStrength = 1

-- POOLS
local pools = {
    Vector3.new(366, 250, -446),
    Vector3.new(348, 264, -499),
    Vector3.new(1639, 260, 2250),
    Vector3.new(-2303, 977, 1072),
    Vector3.new(-2051, 714, -1893)
}

-- GUI ROOT
local gui = Instance.new("ScreenGui")
gui.Name = "SPTSAuto"
gui.ResetOnSpawn = false
gui.Parent = PlayerGui

-- PANEL
local panel = Instance.new("Frame", gui)
panel.Size = UDim2.new(0, 400, 0, 300)
panel.Position = UDim2.new(0.3, 0, 0.3, 0)
panel.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
panel.Active = true
panel.Draggable = true
Instance.new("UICorner", panel).CornerRadius = UDim.new(0, 12)

-- TITLE
local title = Instance.new("TextLabel", panel)
title.Text = "⚡ SPTS Auto (By Zwac)"
title.Size = UDim2.new(1, 0, 0, 28)
title.Position = UDim2.new(0, 0, 0, 2)
title.BackgroundTransparency = 1
title.TextColor3 = Color3.fromRGB(230, 230, 230)
title.Font = Enum.Font.GothamBold
title.TextSize = 18

-- SMALL TOGGLE BUTTON
local miniBtn = Instance.new("TextButton", gui)
miniBtn.Size = UDim2.new(0, 40, 0, 40)
miniBtn.Position = UDim2.new(0, 10, 0, 200)
miniBtn.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
miniBtn.Text = "☰"
miniBtn.TextColor3 = Color3.fromRGB(230, 230, 230)
miniBtn.Font = Enum.Font.GothamBold
miniBtn.TextSize = 20
miniBtn.Visible = false
miniBtn.Active = true
miniBtn.Draggable = true
Instance.new("UICorner", miniBtn).CornerRadius = UDim.new(1, 0)

miniBtn.MouseButton1Click:Connect(function()
    panel.Visible = true
    miniBtn.Visible = false
end)

-- TOGGLE BUTTON
local toggleBtn = Instance.new("TextButton", panel)
toggleBtn.Size = UDim2.new(0, 50, 0, 50)
toggleBtn.Position = UDim2.new(1, -60, 0, 2)
toggleBtn.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
toggleBtn.Text = "❌"
toggleBtn.TextColor3 = Color3.fromRGB(230, 230, 230)
toggleBtn.Font = Enum.Font.GothamBold
toggleBtn.TextSize = 26
Instance.new("UICorner", toggleBtn).CornerRadius = UDim.new(1, 0)

toggleBtn.MouseButton1Click:Connect(function()
    panel.Visible = false
    miniBtn.Visible = true
end)

-- Discord Button
local discordBtn = Instance.new("TextButton", panel)
discordBtn.Size = UDim2.new(0, 120, 0, 28)
discordBtn.Position = UDim2.new(1, -130, 1, -38)
discordBtn.BackgroundColor3 = Color3.fromRGB(80, 80, 220)
discordBtn.Text = "Discord"
discordBtn.TextColor3 = Color3.fromRGB(240, 240, 240)
discordBtn.Font = Enum.Font.GothamBold
discordBtn.TextSize = 14
Instance.new("UICorner", discordBtn).CornerRadius = UDim.new(0, 8)
discordBtn.MouseButton1Click:Connect(function()
    if setclipboard then setclipboard("https://discord.gg/xwUDTAKFK5") end
end)

-- CATEGORY BUTTONS
local categories = {"Teleports","Farms","Auto","Misc","Settings"}
local catFrames = {}
for i,cat in ipairs(categories) do
    local btn = Instance.new("TextButton", panel)
    btn.Size = UDim2.new(0, 80, 0, 28)
    btn.Position = UDim2.new(0, 10, 0, 40 + (i-1)*32)
    btn.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
    btn.Text = cat
    btn.TextColor3 = Color3.fromRGB(255,255,255)
    btn.Font = Enum.Font.GothamBold
    btn.TextSize = 14
    Instance.new("UICorner", btn).CornerRadius = UDim.new(0, 6)

    local frame = Instance.new("Frame", panel)
    frame.Size = UDim2.new(1, -100, 1, -50)
    frame.Position = UDim2.new(0, 100, 0, 40)
    frame.BackgroundTransparency = 1
    frame.Visible = i == 1
    catFrames[cat] = frame

    btn.MouseButton1Click:Connect(function()
        for _,f in pairs(catFrames) do f.Visible = false end
        frame.Visible = true
    end)
end

-- AUTO CATEGORY
local autoFrame = catFrames["Auto"]

-- Clicker Button
local clickerBtn = Instance.new("TextButton", autoFrame)
clickerBtn.Size = UDim2.new(0, 120, 0, 32)
clickerBtn.Position = UDim2.new(0, 10, 0, 10)
clickerBtn.BackgroundColor3 = Color3.fromRGB(40,180,100)
clickerBtn.Text = "Clicker: Off"
clickerBtn.TextColor3 = Color3.fromRGB(240,240,240)
clickerBtn.Font = Enum.Font.GothamBold
clickerBtn.TextSize = 14
Instance.new("UICorner", clickerBtn).CornerRadius = UDim.new(0,8)

clickerBtn.MouseButton1Click:Connect(function()
    running = not running
    clickerBtn.Text = running and "Clicker: On" or "Clicker: Off"
    clickerBtn.BackgroundColor3 = running and Color3.fromRGB(200,80,80) or Color3.fromRGB(40,180,100)
end)

-- Infinite Jump Toggle (Clicker Yanı)
local infiniteJumpBtn = Instance.new("TextButton", autoFrame)
infiniteJumpBtn.Size = UDim2.new(0, 120, 0, 32)
infiniteJumpBtn.Position = UDim2.new(0, 150, 0, 10)
infiniteJumpBtn.BackgroundColor3 = Color3.fromRGB(100,100,220)
infiniteJumpBtn.Text = "Infinite Jump: Off"
infiniteJumpBtn.TextColor3 = Color3.fromRGB(240,240,240)
infiniteJumpBtn.Font = Enum.Font.GothamBold
infiniteJumpBtn.TextSize = 14
Instance.new("UICorner", infiniteJumpBtn).CornerRadius = UDim.new(0,8)

infiniteJumpBtn.MouseButton1Click:Connect(function()
    infiniteJump = not infiniteJump
    infiniteJumpBtn.Text = infiniteJump and "Infinite Jump: On" or "Infinite Jump: Off"
end)

-- Infinite Jump Handler
UserInputService.JumpRequest:Connect(function()
    if infiniteJump then
        local char = Player.Character
        if char and char:FindFirstChild("Humanoid") then
            char.Humanoid:ChangeState(Enum.HumanoidStateType.Jumping)
        end
    end
end)

-- X/Y Position Inputs
local xBox = Instance.new("TextBox", autoFrame)
xBox.Size = UDim2.new(0, 60, 0, 26)
xBox.Position = UDim2.new(0, 10, 0, 50)
xBox.BackgroundColor3 = Color3.fromRGB(40,40,40)
xBox.Text = tostring(clickPosition.X)
xBox.TextColor3 = Color3.fromRGB(220,220,220)
xBox.Font = Enum.Font.Gotham
xBox.TextSize = 14
xBox.ClearTextOnFocus = false
Instance.new("UICorner", xBox).CornerRadius = UDim.new(0,6)

local yBox = Instance.new("TextBox", autoFrame)
yBox.Size = UDim2.new(0, 60, 0, 26)
yBox.Position = UDim2.new(0, 80, 0, 50)
yBox.BackgroundColor3 = Color3.fromRGB(40,40,40)
yBox.Text = tostring(clickPosition.Y)
yBox.TextColor3 = Color3.fromRGB(220,220,220)
yBox.Font = Enum.Font.Gotham
yBox.TextSize = 14
yBox.ClearTextOnFocus = false
Instance.new("UICorner", yBox).CornerRadius = UDim.new(0,6)

local saveBtn = Instance.new("TextButton", autoFrame)
saveBtn.Size = UDim2.new(0, 60, 0, 26)
saveBtn.Position = UDim2.new(0, 150, 0, 50)
saveBtn.BackgroundColor3 = Color3.fromRGB(80,80,200)
saveBtn.Text = "Save"
saveBtn.TextColor3 = Color3.fromRGB(240,240,240)
saveBtn.Font = Enum.Font.GothamBold
saveBtn.TextSize = 14
Instance.new("UICorner", saveBtn).CornerRadius = UDim.new(0,6)

saveBtn.MouseButton1Click:Connect(function()
    local x = tonumber(xBox.Text)
    local y = tonumber(yBox.Text)
    if x and y then
        clickPosition = Vector2.new(x,y)
    end
end)

-- FARMS FRAME
local farmsFrame = catFrames["Farms"]

-- Item Buttons
for i=1,3 do
    local btn = Instance.new("TextButton", farmsFrame)
    btn.Size = UDim2.new(0, 50, 0, 26)
    btn.Position = UDim2.new(0, 10+(i-1)*60, 0, 10)
    btn.Text = tostring(i)
    btn.BackgroundColor3 = Color3.fromRGB(70,70,70)
    btn.TextColor3 = Color3.fromRGB(255,255,255)
    btn.Font = Enum.Font.GothamBold
    btn.TextSize = 14
    Instance.new("UICorner", btn).CornerRadius = UDim.new(0,6)

    btn.MouseButton1Click:Connect(function()
        itemsSelected[i] = not itemsSelected[i]
        if itemsSelected[i] then
            btn.BackgroundColor3 = Color3.fromRGB(70,70,150)
        else
            btn.BackgroundColor3 = Color3.fromRGB(70,70,70)
        end
    end)
end

-- Auto Pool Toggle
local poolBtn = Instance.new("TextButton", farmsFrame)
poolBtn.Size = UDim2.new(0,120,0,28)
poolBtn.Position = UDim2.new(0, 10, 0, 200)
poolBtn.Text = "Auto Pool: Off"
poolBtn.BackgroundColor3 = Color3.fromRGB(200,50,50)
poolBtn.TextColor3 = Color3.fromRGB(240,240,240)
poolBtn.Font = Enum.Font.GothamBold
poolBtn.TextSize = 14
Instance.new("UICorner", poolBtn).CornerRadius = UDim.new(0,8)

poolBtn.MouseButton1Click:Connect(function()
    autoPool = not autoPool
    poolBtn.Text = autoPool and "Auto Pool: On" or "Auto Pool: Off"
    hasTeleported = false
end)

-- AUTO STRENGTH BUTTON
local strengthBtn = Instance.new("TextButton", farmsFrame)
strengthBtn.Size = UDim2.new(0,120,0,28)
strengthBtn.Position = UDim2.new(0, 140, 0, 200)
strengthBtn.Text = "Auto Strength: Off"
strengthBtn.BackgroundColor3 = Color3.fromRGB(200,120,50)
strengthBtn.TextColor3 = Color3.fromRGB(240,240,240)
strengthBtn.Font = Enum.Font.GothamBold
strengthBtn.TextSize = 14
Instance.new("UICorner", strengthBtn).CornerRadius = UDim.new(0,8)

strengthBtn.MouseButton1Click:Connect(function()
    autoStrength = not autoStrength
    strengthBtn.Text = autoStrength and "Auto Strength: On" or "Auto Strength: Off"
    hasTeleStrengthTeleported = false
end)

-- Strength Location Buttons
local strengthLocationBtns = {}
for i=1,#strengthLocations do
    local btn = Instance.new("TextButton", farmsFrame)
    btn.Size = UDim2.new(0,50,0,26)
    btn.Position = UDim2.new(0, 270+(i-1)*60, 0, 200)
    btn.Text = "S"..i
    btn.BackgroundColor3 = Color3.fromRGB(70,70,70)
    btn.TextColor3 = Color3.fromRGB(255,255,255)
    btn.Font = Enum.Font.GothamBold
    btn.TextSize = 14
    Instance.new("UICorner", btn).CornerRadius = UDim.new(0,6)
    strengthLocationBtns[i] = btn
    btn.MouseButton1Click:Connect(function()
        selectedStrength = i
        for j,b in ipairs(strengthLocationBtns) do
            b.BackgroundColor3 = (j==i) and Color3.fromRGB(70,70,150) or Color3.fromRGB(70,70,70)
        end
    end)
end

-- CLICK LOOP
task.spawn(function()
    while true do
        if running and clickPosition then
            VirtualInputManager:SendMouseButtonEvent(
                clickPosition.X, clickPosition.Y,0,true,game,1
            )
            VirtualInputManager:SendMouseButtonEvent(
                clickPosition.X, clickPosition.Y,0,false,game,1
            )
        end
        task.wait(0.05)
    end
end)

-- AUTO POOL LOOP
local function doTeleport()
    local char = Player.Character
    if char and char:FindFirstChild("HumanoidRootPart") and autoPool then
        char.HumanoidRootPart.CFrame = CFrame.new(pools[selectedPool])
        hasTeleported = true
    end
end

RunService.RenderStepped:Connect(function()
    local char = Player.Character
    if char and char:FindFirstChild("HumanoidRootPart") and autoPool then
        local pos = char.HumanoidRootPart.Position
        if lastPos and (pos-lastPos).Magnitude > 1 then hasTeleported = false end
        lastPos = pos
    end
end)

task.spawn(function()
    while true do
        if autoPool and not hasTeleported then doTeleport() end
        -- SPAWN BYPASS
        local char = Player.Character
        if char and char:FindFirstChild("Humanoid") then
            local hum = char.Humanoid
            local c = math.floor(hum.Health)
            local d = math.floor(hum.MaxHealth)*60/100
            if c<=d then momentorespawn=true end
            if momentorespawn then
                char:Remove()
                task.wait(0.1)
                game:GetService("ReplicatedStorage").RemoteEvent:FireServer({"Respawn"})
                task.wait(0.1)
                momentorespawn=false
            end
        end
        task.wait(0.4)
    end
end)

-- AUTO STRENGTH LOOP
task.spawn(function()
    while true do
        if autoStrength then
            local char = Player.Character
            if char and char:FindFirstChild("HumanoidRootPart") then
                local hrp = char.HumanoidRootPart
                local pos = hrp.Position

                local targetPos = strengthLocations[selectedStrength]
                if not hasTeleStrengthTeleported or (pos - targetPos).Magnitude > 5 then
                    hrp.CFrame = CFrame.new(targetPos)
                    hasTeleStrengthTeleported = true
                end

                local args = {[1] = {[1] = "Add_FS_Request"}}
                game:GetService("ReplicatedStorage").RemoteEvent:FireServer(unpack(args))

                VirtualInputManager:SendMouseButtonEvent(
                    clickPosition.X, clickPosition.Y,0,true,game,1
                )
                VirtualInputManager:SendMouseButtonEvent(
                    clickPosition.X, clickPosition.Y,0,false,game,1
                )
            end
        else
            hasTeleStrengthTeleported = false
        end
        task.wait(0.1)
    end
end)

-- DEATH / RESPAWN HANDLER
local function setupDeathHandler()
    local function connectDied()
        local char = Player.Character
        if char then
            local hum = char:FindFirstChildOfClass("Humanoid")
            if hum then
                hum.Died:Connect(function()
                    hasTeleported=false
                    hasTeleStrengthTeleported=false
                    task.wait(1)
                    Player.CharacterAdded:Wait()
                    task.wait(0.5)
                    doTeleport()
                end)
            end
        end
    end
    Player.CharacterAdded:Connect(function() task.wait(0.5); connectDied() end)
    connectDied()
end
setupDeathHandler()
