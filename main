-- SERVICES
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local VirtualInputManager = game:GetService("VirtualInputManager")
local Player = Players.LocalPlayer
local PlayerGui = Player:WaitForChild("PlayerGui")

-- STATE VARS
local running = false
local infiniteJump = false
local autoPool = false
local hasTeleported = false
local lastPos = nil
local clickPosition = Vector2.new(401, 270) -- default
local equippedItems = {false,false,false} -- 1,2,3
local selectedCategory = "Auto"

-- GUI ROOT
local gui = Instance.new("ScreenGui")
gui.Name = "SPTSAuto"
gui.ResetOnSpawn = false
gui.Parent = PlayerGui

-- LEFT CATEGORY PANEL (VERTICAL)
local catPanel = Instance.new("Frame", gui)
catPanel.Size = UDim2.new(0, 80, 1, 0)
catPanel.Position = UDim2.new(0,0,0,0)
catPanel.BackgroundColor3 = Color3.fromRGB(25,25,25)
Instance.new("UICorner", catPanel).CornerRadius = UDim.new(0,12)

local categories = {
    {"Teleports ðŸŠ", "Teleports"},
    {"Farms ðŸŒ¾", "Farms"},
    {"Auto âš¡", "Auto"},
    {"Misc ðŸ› ", "Misc"},
    {"Settings âš™ï¸", "Settings"}
}

local catButtons = {}
for i,cat in ipairs(categories) do
    local btn = Instance.new("TextButton", catPanel)
    btn.Size = UDim2.new(1,0,0,50)
    btn.Position = UDim2.new(0,0,0,(i-1)*55)
    btn.BackgroundColor3 = Color3.fromRGB(40,40,40)
    btn.Text = cat[1]
    btn.TextColor3 = Color3.fromRGB(230,230,230)
    btn.Font = Enum.Font.GothamBold
    btn.TextSize = 14
    Instance.new("UICorner", btn).CornerRadius = UDim.new(0,8)
    btn.MouseButton1Click:Connect(function()
        selectedCategory = cat[2]
        updateRightPanel()
    end)
    table.insert(catButtons, btn)
end

-- RIGHT PANEL (HORIZONTAL)
local rightPanel = Instance.new("Frame", gui)
rightPanel.Size = UDim2.new(1,-90,1,0)
rightPanel.Position = UDim2.new(0,90,0,0)
rightPanel.BackgroundColor3 = Color3.fromRGB(35,35,35)
Instance.new("UICorner", rightPanel).CornerRadius = UDim.new(0,12)

-- TOGGLE PANEL VISIBILITY
local toggleBtn = Instance.new("TextButton", gui)
toggleBtn.Size = UDim2.new(0,50,0,50)
toggleBtn.Position = UDim2.new(0.5,-25,0,10)
toggleBtn.BackgroundColor3 = Color3.fromRGB(40,40,40)
toggleBtn.Text = "ðŸ‘ï¸"
toggleBtn.TextColor3 = Color3.fromRGB(230,230,230)
toggleBtn.Font = Enum.Font.GothamBold
toggleBtn.TextSize = 26
Instance.new("UICorner", toggleBtn).CornerRadius = UDim.new(1,0)
local panelVisible = true
toggleBtn.MouseButton1Click:Connect(function()
    panelVisible = not panelVisible
    rightPanel.Visible = panelVisible
    catPanel.Visible = panelVisible
    toggleBtn.Text = panelVisible and "ðŸ‘ï¸" or "âŒ"
end)

-- RIGHT PANEL CONTENT HANDLER
local function clearRightPanel()
    for _,c in ipairs(rightPanel:GetChildren()) do
        if c:IsA("GuiObject") then c:Destroy() end
    end
end

-- POOLS DATA
local pools = {
    Vector3.new(366, 250, -446),
    Vector3.new(348, 264, -499),
    Vector3.new(1639, 260, 2250),
    Vector3.new(-2303, 977, 1072),
    Vector3.new(-2051, 714, -1893)
}
local selectedPool = 1

-- ITEMS DATA
local items = {1,2,3}

-- CLICKER DATA
local xBox, yBox, saveBtn, clickerBtn

-- FPS BOOST TOGGLE
local fpsBoost = false

-- UPDATE RIGHT PANEL BASED ON CATEGORY
function updateRightPanel()
    clearRightPanel()
    if selectedCategory == "Auto" then
        -- Clicker
        clickerBtn = Instance.new("TextButton", rightPanel)
        clickerBtn.Size = UDim2.new(0,150,0,40)
        clickerBtn.Position = UDim2.new(0,10,0,10)
        clickerBtn.BackgroundColor3 = Color3.fromRGB(40,180,100)
        clickerBtn.Text = "Clicker: Off"
        clickerBtn.TextColor3 = Color3.fromRGB(240,240,240)
        clickerBtn.Font = Enum.Font.GothamBold
        clickerBtn.TextSize = 14
        Instance.new("UICorner", clickerBtn).CornerRadius = UDim.new(0,8)
        clickerBtn.MouseButton1Click:Connect(function()
            running = not running
            clickerBtn.Text = running and "Clicker: On" or "Clicker: Off"
            clickerBtn.BackgroundColor3 = running and Color3.fromRGB(200,80,80) or Color3.fromRGB(40,180,100)
        end)

        -- X/Y Input
        xBox = Instance.new("TextBox", rightPanel)
        xBox.Size = UDim2.new(0,60,0,30)
        xBox.Position = UDim2.new(0,10,0,60)
        xBox.BackgroundColor3 = Color3.fromRGB(40,40,40)
        xBox.Text = tostring(clickPosition.X)
        xBox.TextColor3 = Color3.fromRGB(220,220,220)
        xBox.Font = Enum.Font.Gotham
        xBox.TextSize = 14
        xBox.ClearTextOnFocus = false
        Instance.new("UICorner", xBox).CornerRadius = UDim.new(0,6)

        yBox = Instance.new("TextBox", rightPanel)
        yBox.Size = UDim2.new(0,60,0,30)
        yBox.Position = UDim2.new(0,80,0,60)
        yBox.BackgroundColor3 = Color3.fromRGB(40,40,40)
        yBox.Text = tostring(clickPosition.Y)
        yBox.TextColor3 = Color3.fromRGB(220,220,220)
        yBox.Font = Enum.Font.Gotham
        yBox.TextSize = 14
        yBox.ClearTextOnFocus = false
        Instance.new("UICorner", yBox).CornerRadius = UDim.new(0,6)

        saveBtn = Instance.new("TextButton", rightPanel)
        saveBtn.Size = UDim2.new(0,60,0,30)
        saveBtn.Position = UDim2.new(0,150,0,60)
        saveBtn.BackgroundColor3 = Color3.fromRGB(80,80,200)
        saveBtn.Text = "Save"
        saveBtn.TextColor3 = Color3.fromRGB(240,240,240)
        saveBtn.Font = Enum.Font.GothamBold
        saveBtn.TextSize = 14
        Instance.new("UICorner", saveBtn).CornerRadius = UDim.new(0,6)
        saveBtn.MouseButton1Click:Connect(function()
            local x = tonumber(xBox.Text)
            local y = tonumber(yBox.Text)
            if x and y then clickPosition = Vector2.new(x,y) end
        end)
    elseif selectedCategory == "Farms" then
        for i,v in ipairs(items) do
            local btn = Instance.new("TextButton", rightPanel)
            btn.Size = UDim2.new(0,100,0,40)
            btn.Position = UDim2.new(0,10,0,10+(i-1)*50)
            btn.BackgroundColor3 = Color3.fromRGB(40,40,40)
            btn.Text = "Item "..v
            btn.TextColor3 = Color3.fromRGB(240,240,240)
            btn.Font = Enum.Font.GothamBold
            btn.TextSize = 14
            Instance.new("UICorner", btn).CornerRadius = UDim.new(0,8)
            btn.MouseButton1Click:Connect(function()
                equippedItems[v] = not equippedItems[v]
                btn.BackgroundColor3 = equippedItems[v] and Color3.fromRGB(80,160,255) or Color3.fromRGB(40,40,40)
            end)
        end
    elseif selectedCategory == "Teleports" then
        for i,v in ipairs(pools) do
            local btn = Instance.new("TextButton", rightPanel)
            btn.Size = UDim2.new(0,150,0,40)
            btn.Position = UDim2.new(0,10,0,10+(i-1)*50)
            btn.BackgroundColor3 = Color3.fromRGB(70,70,70)
            btn.Text = "Pool "..i.." ðŸŠ"
            btn.TextColor3 = i==selectedPool and Color3.fromRGB(100,170,255) or Color3.fromRGB(240,240,240)
            btn.Font = Enum.Font.GothamBold
            btn.TextSize = 14
            Instance.new("UICorner", btn).CornerRadius = UDim.new(0,8)
            btn.MouseButton1Click:Connect(function()
                selectedPool = i
                updateRightPanel()
            end)
        end
    elseif selectedCategory == "Misc" then
        local btn = Instance.new("TextButton", rightPanel)
        btn.Size = UDim2.new(0,150,0,40)
        btn.Position = UDim2.new(0,10,0,10)
        btn.BackgroundColor3 = Color3.fromRGB(40,40,40)
        btn.Text = "FPS Boost ðŸ› : Off"
        btn.TextColor3 = Color3.fromRGB(240,240,240)
        btn.Font = Enum.Font.GothamBold
        btn.TextSize = 14
        Instance.new("UICorner", btn).CornerRadius = UDim.new(0,8)
        btn.MouseButton1Click:Connect(function()
            fpsBoost = not fpsBoost
            btn.Text = "FPS Boost ðŸ› : "..(fpsBoost and "On" or "Off")
        end)
    elseif selectedCategory == "Settings" then
        -- ÅŸimdilik boÅŸ
    end
end

updateRightPanel()

-- CLICK LOOP
task.spawn(function()
    while true do
        if running and clickPosition then
            VirtualInputManager:SendMouseButtonEvent(clickPosition.X, clickPosition.Y,0,true,game,1)
            VirtualInputManager:SendMouseButtonEvent(clickPosition.X, clickPosition.Y,0,false,game,1)
            task.wait(0.05)
        else
            task.wait(0.05)
        end
    end
end)

-- INFINITE JUMP
RunService.RenderStepped:Connect(function()
    if infiniteJump then
        local char = Player.Character
        if char then
            local hum = char:FindFirstChildOfClass("Humanoid")
            if hum and hum:GetState() == Enum.HumanoidStateType.Landed then
                hum:ChangeState(Enum.HumanoidStateType.Jumping)
            end
        end
    end
end)

-- AUTO POOL TELEPORT
local function doTeleport()
    local char = Player.Character
    if char and char:FindFirstChild("HumanoidRootPart") and autoPool then
        char.HumanoidRootPart.CFrame = CFrame.new(pools[selectedPool])
        hasTeleported = true
    end
end

RunService.RenderStepped:Connect(function()
    local char = Player.Character
    if char and char:FindFirstChild("HumanoidRootPart") and autoPool then
        local pos = char.HumanoidRootPart.Position
        if lastPos and (pos-lastPos).Magnitude > 1 then hasTeleported = false end
        lastPos = pos
    end
end)

task.spawn(function()
    while true do
        if autoPool and not hasTeleported then doTeleport() end
        task.wait(0.4)
    end
end)

-- DEATH / RESPAWN
local function setupDeathHandler()
    local function connectDied()
        local char = Player.Character
        if char then
            local hum = char:FindFirstChildOfClass("Humanoid")
            if hum then
                hum.Died:Connect(function()
                    hasTeleported = false
                    task.wait(1)
                    Player.CharacterAdded:Wait()
                    task.wait(0.5)
                    doTeleport()
                    -- Re-equip items
                    for i,v in ipairs(equippedItems) do
                        if v then
                            -- simulate 1,2,3 key press
                            local key = Enum.KeyCode["One"]
                            if i==2 then key=Enum.KeyCode.Two end
                            if i==3 then key=Enum.KeyCode.Three end
                            VirtualInputManager:SendKeyEvent(true,key,false,game)
                            VirtualInputManager:SendKeyEvent(false,key,false,game)
                        end
                    end
                end)
            end
        end
    end
    Player.CharacterAdded:Connect(function() task.wait(0.5); connectDied() end)
    connectDied()
end
setupDeathHandler()
